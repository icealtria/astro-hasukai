---
import { posts } from "@/utils/post";
import Home from "@/layouts/Home.astro";
import { SITE } from "@/consts";
import PostList from "@/components/PostList.astro";
import { Icon } from "astro-icon/components";
import type { GetStaticPathsOptions } from "astro";
import PageContainer from "@/components/PageContainer.astro";
import Headline from "@/components/Headline.astro";
export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
    const sorted_posts = posts.sort(
        (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
    );
    return paginate(sorted_posts, {
        pageSize: SITE.postPerPage,
    });
}
const { page } = Astro.props;
---

<Home
    title={`Posts - 第 ${page.currentPage} 页 - ${SITE.title}`}
    description={SITE.description}
>
    <Headline title="Posts" />
    <div class="bg-primary-container">
        <PageContainer>
            <PostList posts={page.data} big={true} />
        </PageContainer>
        <div class="flex justify-center py-12 mx-10">
            <!-- <div class="prev">
                {
                    page.url.prev ? (
                        <a
                            href={page.url.prev}
                            class:list={"pagination-item"}
                            aria-label="Previous"
                        >
                            <Icon name="ic:baseline-chevron-left" />
                        </a>
                    ) : (
                        <div class="pagination-item no-next">
                            <Icon name="ic:baseline-chevron-left" />
                        </div>
                    )
                }
            </div> -->

            <div class="page-numbers flex gap-4">
                {
                    Array.from({ length: page.lastPage }, (_, index) => {
                        const pageNumber = index + 1;
                        return (
                            <a
                                href={`/page/${pageNumber}`}
                                class:list={[
                                    "pagination-item",
                                    pageNumber === page.currentPage
                                        ? "page-active"
                                        : "",
                                ]}
                                aria-label={`Page ${pageNumber}`}
                            >
                                {pageNumber}
                            </a>
                        );
                    })
                }
            </div>

            <!-- <div class="next">
                {
                    page.url.next ? (
                        <a
                            href={page.url.next}
                            class:list={"pagination-item"}
                            aria-label="Next"
                        >
                            <Icon name="ic:baseline-chevron-right" />
                        </a>
                    ) : (
                        <div class="pagination-item no-next">
                            <Icon name="ic:baseline-chevron-right" />
                        </div>
                    )
                }
            </div> -->
        </div>
    </div>
</Home>

<style>
    .pagination-item {
        @apply w-12 h-12 border bg-surface-container-lowest border-outline font-semibold transition-colors flex items-center justify-center align-middle hover:bg-surface-container;
    }

    /* .no-next {
        @apply pointer-events-none opacity-50;
    } */

    .page-active {
        @apply bg-surface-container;
    }

    .list::before {
        content: "";
        display: block;
        width: 100%;
        height: 40px;
        border-left: #383834 solid 1px;
        border-right: #383834 solid 1px;
        box-sizing: border-box;
    }

    .list {
        @apply px-10 border-outline;
    }
</style>
